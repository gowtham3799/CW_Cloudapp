sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment","sap/ui/core/BusyIndicator","sap/ui/core/Element","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,a,r,o,l,s){"use strict";return e.extend("viapp.controller.Services",{onInit:function(){this._oRouter=sap.ui.core.UIComponent.getRouterFor(this);this._oRouter.attachRouteMatched(this.handleRouteMatched,this)},handleRouteMatched:function(e){var t=this.getView().getModel("oGlobalModel");if(e.getParameter("name")==="Services"){var i=this.getView().getModel("oGlobalModel").getData().MainPlant;this._ModelInitialLoad();this.getMaterialF4();var a=this.getView().getModel("ServicesViewModel").getData().CWMaterial;for(var r=0;r<a.length;r++){a[r].Highlight==="None";a[r].Type="Active";this.getView().addStyleClass("cl_wgridlist");this.getView().removeStyleClass("cl_wgridlistSeleted")}}},onExit:function(){alert("Exit")},onPressCloseSearch:function(){this.SearchVehicle.close()},onPressmainHome:function(){var e=sap.ushell.Container.getService("CrossApplicationNavigation");e.toExternal({target:{shellHash:"#Shell-home"}});var t=sap.ushell.Container.getRenderer("fiori2");t.setHeaderVisibility(true,false)},onSearchNewMaterialF4:function(e){var t=e.getParameter("newValue");var i=new Array;var a=new sap.ui.model.Filter([new sap.ui.model.Filter("Material",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("MaterialName",sap.ui.model.FilterOperator.Contains,t)],false);i=a;var r=this.getView().byId("idgridlist");var o=r.getBinding("items");o.filter(i)},onSearchLPGMaterialSearch:function(){var e=oEvent.getParameter("newValue");var t=new Array;var i=new sap.ui.model.Filter([new sap.ui.model.Filter("Material",sap.ui.model.FilterOperator.Contains,e),new sap.ui.model.Filter("MaterialName",sap.ui.model.FilterOperator.Contains,e)],false);t=i;var a=this.getView().byId("idgridlist");var r=a.getBinding("items");r.filter(t)},onAfterRendering:function(){this._ModelInitialLoad()},_ModelInitialLoad:function(){var e={GassItemBG:"{imageModel>/path}/image/DesignCar.png",CWMaterial:[{Material:"2822957303",MaterialName:"Rainbow Foam Full Wash",Quantity:"1",Price:"150.00",Tax:"2.5",Highlight:"None",Type:"Active"},{Material:"2861928504",MaterialName:"Interior Cleaning",Price:"40.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2911859358",MaterialName:"Underbody Flush",Price:"60.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2709919403",MaterialName:"Wheel Washing",Price:"140.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2756492720",MaterialName:"Waxing",Price:"170.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2822957303",MaterialName:"Car sanitization",Price:"50.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2700494918",MaterialName:"Automatic Car wash",Price:"40.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2811746280",MaterialName:"Manual Car wash",Price:"100.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2600954298",MaterialName:"Full Service Car Wash",Price:"140.00",Quantity:"1",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2790947298",MaterialName:"Bike Wash",Price:"20.00",Tax:"1",Highlight:"None",Type:"Active"}],LPGMaterial:[{Material:"2800000090",MaterialName:"Gas Cylinder 5.5Kg",Price:"8.00",Tax:"2.5",Highlight:"None",Type:"Active"},{Material:"2800000010",MaterialName:"Gas Cylinder 11Kg",Price:"14.00",Tax:"2.5",Highlight:"None",Type:"Active"},{Material:"2800000011",MaterialName:"Gas Cylinder 22Kg",Price:"25.00",Tax:"2.5",Highlight:"None",Type:"Active"},{Material:"2800000011",MaterialName:"Gas Cylinder 44Kg",Price:"25.00",Tax:"2.5",Highlight:"None",Type:"Active"},{Material:"2800000030",MaterialName:"Small LPG 25lbs",Price:"35.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2800000031",MaterialName:"Large LPG 50lbs",Price:"70.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2800000032",MaterialName:"LPG regulator 25mbar",Price:"14.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2756492720",MaterialName:"LPG regulator 30mbar",Price:"70.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2822957303",MaterialName:"LPG regulator 10mbar",Price:"50.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2822957305",MaterialName:"1.5M LPG Rubber Hose Pipe ",Price:"10.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2754362613",MaterialName:"2.5M LPG Rubber Hose Pipe",Price:"20.00",Tax:"1",Highlight:"None",Type:"Active"},{Material:"2754362614",MaterialName:"5M LPG Rubber Hose Pipe",Price:"34.00",Tax:"1",Highlight:"None",Type:"Active"}],ProceedSOButtomVisible:true,PaymentButtomVisible:false,Printvisible:false,IdentifyVisible:false,MOPVisible:false,CashMOPPanelExpand:false,CardMOPPanelExpand:false,Cash_CheckBoxSeleted:false,Card_CheckBoxSeleted:false,LoyaltyMOPPanelExpand:false,Loyalty_CheckBoxSeleted:false,Coupon_CheckBoxSeleted:false,Loyalty_ScanedID:"",Loyalty_ScanedPoint:"",Loyalty_ScanedAmount:"",Cart_Material:"",Cart_MaterialDesc:"",Cart_TotalAmount:"",Cart_NetAmount:"",Cart_TaxAmount:"",MaterialList:[{Material:"1500083163",MaterialName:"Air Purifier",MaterialType:"SER",UOM:"L",NetPrice:"29.00",TaxPrice:"1.50",Total:"30.50",Stock:"25.00",ConsignmentStock:"125.00",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083168",MaterialName:"Air Freshener â€“ Assorted Pack (22.5g) ",MaterialType:"SER",UOM:"EA",NetPrice:"29.00",TaxPrice:"1.50",Total:"30.50",Stock:"200",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083170",MaterialName:"Scratch Remover Spray",MaterialType:"SER",UOM:"EA",NetPrice:"19.00",TaxPrice:"1.00",Total:"20.00",Stock:"70",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083171",MaterialName:"Microfiber Car Duster Kit ",MaterialType:"SER",UOM:"EA",NetPrice:"14.00",TaxPrice:"1.00",Total:"15.00",Stock:"100",ConsignmentStock:"10",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083172",MaterialName:"Multi Color Interior Atmosphere Light for Dashboard",MaterialType:"SER",UOM:"EA",NetPrice:"200.00",TaxPrice:"1.50",Total:"201.50",Stock:"100",ConsignmentStock:"25",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083174",MaterialName:"Seat Cushion",MaterialType:"SER",UOM:"EA",NetPrice:"100.00",TaxPrice:"1.50",Total:"101.50",Stock:"100",ConsignmentStock:"55",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083175",MaterialName:"Sun Shade for Side Windows (BLACK 2)",MaterialType:"SER",UOM:"EA",NetPrice:"25.00",TaxPrice:"1.50",Total:"26.50",Stock:"100",ConsignmentStock:"75",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083176",MaterialName:"Flat Wiper Blade MULTI-FIT 14 inch",MaterialType:"SER",UOM:"EA",NetPrice:"55.00",TaxPrice:"1.50",Total:"56.50",Stock:"120",ConsignmentStock:"50",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083178",MaterialName:"3M Specialty Cream Wax",MaterialType:"SER",UOM:"EA",NetPrice:"25.00",TaxPrice:"1.50",Total:"26.50",Stock:"120",ConsignmentStock:"30",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083179",MaterialName:"Polish liquid",MaterialType:"SER",UOM:"EA",NetPrice:"25.00",TaxPrice:"1.50",Total:"26.50",Stock:"120",ConsignmentStock:"30",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083180",MaterialName:"Frameless wiper blades Size 24 ' x 16'\tInches ",MaterialType:"SER",UOM:"EA",NetPrice:"25.00",TaxPrice:"1.50",Total:"26.50",Stock:"120",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083181",MaterialName:"Universal Charger",MaterialType:"SER",UOM:"EA",NetPrice:"55.00",TaxPrice:"1.50",Total:"56.50",Stock:"120",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083182",MaterialName:"Phone Mount ",MaterialType:"SER",UOM:"L",NetPrice:"35.00",TaxPrice:"1.50",Total:"36.50",Stock:"120",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083183",MaterialName:"Floor Mats",MaterialType:"SER",UOM:"EA",NetPrice:"35.00",TaxPrice:"1.50",Total:"36.50",Stock:"120",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083185",MaterialName:"Tire Puncture Kit",MaterialType:"SER",UOM:"EA",NetPrice:"35.00",TaxPrice:"1.50",Total:"36.50",Stock:"120",ConsignmentStock:"30",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083187",MaterialName:"Fog Lights ",MaterialType:"SER",UOM:"EA",NetPrice:"55.00",TaxPrice:"1.50",Total:"56.50",Stock:"120",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083188",MaterialName:"Emergency Hammer ",MaterialType:"SER",UOM:"EA",NetPrice:"55.00",TaxPrice:"1.50",Total:"56.50",Stock:"10",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""},{Material:"1500083189",MaterialName:"Mini Car Trash Bin Can Holder Dustbin - Black (L 17 x W 6.5 cms)",MaterialType:"SER",UOM:"EA",NetPrice:"55.00",TaxPrice:"1.50",Total:"56.50",Stock:"120",ConsignmentStock:"20",Highlight:"None",Type:"Active",LPG:""}],SO_Number:"Not Started",MyCartItems:[],MyCartItemCount:"0",MyCartTotal:"0",MyCartCount:"0",Loyaltyamount:"0",Cashamount:"0",CouponAmount:"0",CardAmount:"0",CouponNumber:"",LoyaltyRef:"",Authcode:""};var t=new sap.ui.model.json.JSONModel(e);this.getView().setModel(t,"ServicesViewModel");var e={CNC_NewCustomer:false,CNC_CustomerForm:true,CNC_VehicleForm:true};var i=new sap.ui.model.json.JSONModel(e);this.getView().setModel(i,"HomeViewModel");var e={CC_FirstName:"",CC_LastName:"",CC_Email:"",CC_MobileNo:"",CC_HouseNo:"",CC_Street:"",CC_City:"",CC_PostalCode:"",CC_Country:"",CC_Remark:"",CC_FirstName_ValueState:"None",CC_MobileNo_ValueState:"None",AddVehicleData:[],CC_AddVehicleSwitch:false,CC_Emirates:"",CC_Category:"",CC_PlateCode:"",CC_PlateNo:"",CC_VINNo:"",CC_Manfacturer:"",CC_Model:"",CC_CarType:"",CC_FuelType:"",CC_Year:"",AddVehicleList:[],EmiratesF4:[{Emirates:"Abu Dhabi"},{Emirates:"Dubai"},{Emirates:"Sharjah"},{Emirates:"Ajman"},{Emirates:"Umm Al Quwain"},{Emirates:"Ras Al Khaimah"},{Emirates:"Fujairah"},{Emirates:"Others"}],PlateCategoryF4:[{Category:"Classic"},{Category:"Export"},{Category:"MotorCycle"},{Category:"Other"},{Category:"Private"},{Category:"Taxi"},{Category:"Police"},{Category:"Trade Plate"}],PlateCodeF4:[{PlateCode:"A"},{PlateCode:"1"},{PlateCode:"B"},{PlateCode:"2"},{PlateCode:"C"},{PlateCode:"3"},{PlateCode:"D"},{PlateCode:"4"}],FuelTypeF4:[{FuelType:"Diesel"},{FuelType:"Petrol"},{FuelType:"Gas"},{FuelType:"Electric"},{FuelType:"Others"}],ManufacturerF4:[{Manufacture:"Audi"},{Manufacture:"BMW"},{Manufacture:"Benz"},{Manufacture:"Ford"},{Manufacture:"Ferrari"},{Manufacture:"Hyundai"},{Manufacture:"Honda"},{Manufacture:"Land Rover"},{Manufacture:"Porsche"},{Manufacture:"Rolls-Royce"},{Manufacture:"Toyota"},{Manufacture:"Others"}],ModelF4Set:[{Manufacture:"Audi",Model:"A1"},{Manufacture:"Audi",Model:"A2"},{Manufacture:"Audi",Model:"A3"},{Manufacture:"Audi",Model:"Q1"},{Manufacture:"Audi",Model:"Q3"},{Manufacture:"BMW",Model:"X1"},{Manufacture:"BMW",Model:"X3"},{Manufacture:"BMW",Model:"M2"},{Manufacture:"Benz",Model:"EQS"},{Manufacture:"Benz",Model:"GLB"},{Manufacture:"Benz",Model:"GLC"},{Manufacture:"Ford",Model:"Aerostar"},{Manufacture:"Ford",Model:"Mustang"},{Manufacture:"Ford",Model:"EcoSport"},{Manufacture:"Ferrari",Model:"F8 Tributo"},{Manufacture:"Hyundai",Model:"Creta"},{Manufacture:"Honda",Model:"Amaze"},{Manufacture:"Land Rover",Model:"Range Rover"},{Manufacture:"Land Rover",Model:"Defender"},{Manufacture:"Porsche",Model:"GTS"},{Manufacture:"Rolls-Royce",Model:"Ghost"},{Manufacture:"Rolls-Royce",Model:"Cullinan"},{Manufacture:"Toyota",Model:"Glanza"},{Manufacture:"Others"}],ModelF4:[]};var a=new sap.ui.model.json.JSONModel(e);this.getView().setModel(a,"oViewModel")},onPressCart:function(){this.AddToCart=sap.ui.xmlfragment("viapp.fragment.AddToCart",this);this.getView().addDependent(this.AddToCart);this.AddToCart.open();var e=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");this.getView().getModel("ServicesViewModel").setProperty("/MyCartItemCount",e.length);var t=e.map(e=>e.Total).reduce((e,t)=>parseFloat(e)+parseFloat(t));this.getView().getModel("ServicesViewModel").setProperty("/MyCartTotal",parseFloat(t).toFixed(2));this.getView().getModel("ServicesViewModel").setProperty("/ProceedSOButtomVisible",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/IdentifyVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",false);this.getView().getModel("ServicesViewModel").refresh()},onCloseCart:function(){sap.m.MessageBox.confirm("Are you sure want to close?",{icon:sap.m.MessageBox.Icon.CONFIRM,title:"Confirmation",actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(e){if(e==="YES"){this.AddToCart.close();this.getView().getModel("ServicesViewModel").setProperty("/ProceedSOButtomVisible",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/IdentifyVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",false);this.getView().getModel("ServicesViewModel").refresh()}else if(e==="NO"){}}.bind(this)})},onPressProceedSale:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");var a=this.getView().getModel("oGlobalModel").getProperty("/Profile_PlateNo");var o=this.getView().getModel("oGlobalModel").getProperty("/Profile_PlateCode");var l=this.getView().getModel("oGlobalModel").getProperty("/Profile_Emirates");var s=this.getView().getModel("oGlobalModel").getProperty("/MainPlant");var n=[];var d=10;for(var g=0;g<e.length;g++){var M=d.toString();var c={ITEMNUM:M,MATERIAL:e[g].Material,PLANT:s,MATERIALDESC:e[g].MaterialName,QUANTITY:"1.00",UOM:"EA",NETPRICE:parseFloat(e[g].Price),CURRENCY:"AED"};d=d+10;n.push(c)}var h={PLATECODE:o,PLATENUM:a,SOURCE:l,KIND:"PRIVATE",ITEMS:n};r.show();this.getView().getModel("CarwashService").create("/Order",h,{success:function(e,i){r.hide();if(e.ORDERNUM!==""){var a=e.ORDERNUM;this.getView().getModel("ServicesViewModel").setProperty("/ProceedSOButtomVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",true);t.show("#"+a+" Saleorder created successfully");this.getView().getModel("ServicesViewModel").setProperty("/SO_Number",a);this.getView().getModel("ServicesViewModel").setProperty("/SO_id",e.ID);this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",true)}}.bind(this),error:function(e){r.hide();i.error(e.message)}.bind(this)})},onPressContinueguest:function(){this.getView().getModel("ServicesViewModel").setProperty("/IdentifyVisible",true);this.getView().getModel("ServicesViewModel").setProperty("/MOP",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",true)},onPressCashSelect:function(e){var t=e.getSource().getSelected();if(t){this.getView().getModel("ServicesViewModel").setProperty("/CashMOPPanelExpand",true);var i=this.getView().getModel("ServicesViewModel").getProperty("/MyCartTotal");this.getView().getModel("ServicesViewModel").setProperty("/Cashamount",i)}else{this.getView().getModel("ServicesViewModel").setProperty("/CashMOPPanelExpand",false);this.getView().getModel("ServicesViewModel").setProperty("/Cashamount","0")}this.getView().getModel("ServicesViewModel").refresh()},onPressCardSelect:function(e){var t=e.getSource().getSelected();if(t){this.getView().getModel("ServicesViewModel").setProperty("/CardMOPPanelExpand",true);var i=this.getView().getModel("ServicesViewModel").getProperty("/MyCartTotal");this.getView().getModel("ServicesViewModel").setProperty("/CardAmount",i)}else{this.getView().getModel("ServicesViewModel").setProperty("/CardMOPPanelExpand",false);this.getView().getModel("ServicesViewModel").setProperty("/CardAmount","0")}this.getView().getModel("ServicesViewModel").refresh()},onPressLoyaltySelect:function(e){var t=e.getSource().getSelected();if(t){this.getView().getModel("ServicesViewModel").setProperty("/LoyaltyMOPPanelExpand",true)}else{this.getView().getModel("ServicesViewModel").setProperty("/LoyaltyMOPPanelExpand",false)}this.getView().getModel("ServicesViewModel").refresh()},onExpandCash:function(e){var t=e.getSource().getExpanded();if(t){this.getView().getModel("ServicesViewModel").setProperty("/Cash_CheckBoxSeleted",true);var i=this.getView().getModel("ServicesViewModel").getProperty("/MyCartTotal");this.getView().getModel("ServicesViewModel").setProperty("/CashAmount",i)}else{this.getView().getModel("ServicesViewModel").setProperty("/Cash_CheckBoxSeleted",false);this.getView().getModel("ServicesViewModel").setProperty("/CardAmount","0")}},onExpandCard:function(e){var t=e.getSource().getExpanded();if(t){this.getView().getModel("ServicesViewModel").setProperty("/Card_CheckBoxSeleted",true)}else{this.getView().getModel("ServicesViewModel").setProperty("/Card_CheckBoxSeleted",false)}},onExpandLoyalty:function(e){var t=e.getSource().getExpanded();if(t){this.getView().getModel("ServicesViewModel").setProperty("/Loyalty_CheckBoxSeleted",true)}else{this.getView().getModel("ServicesViewModel").setProperty("/Loyalty_CheckBoxSeleted",false)}},onExpandCoupon:function(e){var t=e.getSource().getExpanded();if(t){this.getView().getModel("ServicesViewModel").setProperty("/Coupon_CheckBoxSeleted",true)}else{this.getView().getModel("ServicesViewModel").setProperty("/Coupon_CheckBoxSeleted",false)}},onPress1:function(e){var i=this.getView().getModel("oGlobalModel").getProperty("/Profile_PlateNo");var a=this.getView().getModel("oGlobalModel").getProperty("/Profile_PlateCode");if(a!==""&&a!==""){var r=e.getSource().getBindingContext("ServicesViewModel").getObject();var o=this.getView().getModel("ServicesViewModel").getData().CWMaterial;if(r.Highlight==="None"){e.getSource().getBindingContext("ServicesViewModel").getObject().Highlight="Information";this.getView().getModel("ServicesViewModel").setProperty("/Price",r.Price);e.getSource().removeStyleClass("cl_wgridlist");e.getSource().addStyleClass("cl_wgridlistSeleted");var l=parseFloat(r.Price)*.05;var s=parseFloat(r.Price)+parseFloat(l);this.getView().getModel("ServicesViewModel").setProperty("/Cart_TotalAmount",parseFloat(s).toFixed(2));var n={Material:r.Material,MaterialName:r.MaterialName,Quantity:r.Quantity,Price:r.Price,Tax:parseFloat(l).toFixed(2),Total:parseFloat(s).toFixed(2)};var d=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");d.push(n);this.getView().getModel("ServicesViewModel").refresh();var g=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount",g.length)}else{e.getSource().getBindingContext("ServicesViewModel").getObject().Highlight="None";e.getSource().removeStyleClass("cl_wgridlistSeleted");e.getSource().addStyleClass("cl_wgridlist");var d=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");d=d.filter(function(e){return e.Material!==r.Material});this.getView().getModel("ServicesViewModel").setProperty("/MyCartItems",d);this.getView().getModel("ServicesViewModel").refresh()}this.getView().getModel("ServicesViewModel").refresh();var g=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount",g.length)}else{this.onPressSearchCustomer();t.show("Please select the vehicle")}},onDeleteCartItem:function(e){var t=e.getParameter("listItem").getBindingContext("ServicesViewModel").getPath();var i=e.getSource().getModel("ServicesViewModel");var a=parseInt(t.substring(t.lastIndexOf("/")+1),10);var r=e.getParameter("listItem").getBindingContext("ServicesViewModel").getObject().Material;sap.m.MessageBox.confirm("Do you want to delete?",{icon:sap.m.MessageBox.Icon.CONFIRM,title:"Confirmation",actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(e){if(e==="YES"){var t=i.getProperty("/MyCartItems");t.splice(a,1);i.setProperty("/MyCartItems",t);this.getView().getModel("ServicesViewModel").setProperty("/MyCartItemCount",t.length);var o=this.getView().getModel("ServicesViewModel").getProperty("/CWMaterial");for(var l=0;l<o.length;l++){if(r===o[l].Material){o[l].Highlight="None";o[l].Type="Active"}}var s=this.getView().getModel("ServicesViewModel").getProperty("/MaterialList");for(var l=0;l<s.length;l++){if(r===s[l].Material){s[l].Highlight="None";s[l].Type="Active"}}var n=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");var d=n.reduce((e,t)=>parseFloat(e)+parseFloat(t.Total),0);this.getView().getModel("ServicesViewModel").setProperty("/MyCartTotal",d.toFixed(2));this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount",n.length);this.getView().getModel("ServicesViewModel").refresh()}else if(e==="NO"){}}.bind(this)})},onResetCarwash:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/CWMaterial");for(var t=0;t<e.length;t++){e[t].Highlight="None";e[t].Type="Active"}this.getView().getModel("ServicesViewModel").setProperty("/CWMaterial","");this.getView().getModel("ServicesViewModel").setProperty("/CWMaterial",e);this.getView().getModel("ServicesViewModel").refresh();this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount","0")},onResetProduct:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/MaterialList");for(var t=0;t<e.length;t++){e[t].Highlight="None";e[t].Type="Active"}this.getView().getModel("ServicesViewModel").setProperty("/MaterialList","");this.getView().getModel("ServicesViewModel").setProperty("/MaterialList",e);this.getView().getModel("ServicesViewModel").refresh();this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount","0")},onPress2:function(e){var t=e.getSource().getBindingContext("ServicesViewModel").getObject();var i=this.getView().getModel("ServicesViewModel").getData().LPGMaterial;if(t.Highlight==="None"){e.getSource().getBindingContext("ServicesViewModel").getObject().Highlight="Information";this.getView().getModel("ServicesViewModel").setProperty("/Price",t.Price);e.getSource().removeStyleClass("cl_wgridlist");e.getSource().addStyleClass("cl_wgridlistSeleted");var a=parseFloat(t.Price)+parseFloat(t.Tax);this.getView().getModel("ServicesViewModel").setProperty("/Cart_TotalAmount",parseFloat(a).toFixed(2));var r={Material:t.Material,MaterialName:t.MaterialName,Price:t.Price,Tax:t.Tax,Total:parseFloat(a).toFixed(2)};var o=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");o.push(r);this.getView().getModel("ServicesViewModel").refresh();for(var l=0;l<i.length;l++){if(i[l].Highlight==="None"){i[l].Type="Inactive"}}}else{e.getSource().getBindingContext("ServicesViewModel").getObject().Highlight="None";e.getSource().removeStyleClass("cl_wgridlistSeleted");e.getSource().addStyleClass("cl_wgridlist");var o=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");o=o.filter(function(e){return e.Material!==t.Material});this.getView().getModel("ServicesViewModel").setProperty("/MyCartItems",o);this.getView().getModel("ServicesViewModel").refresh();for(var l=0;l<i.length;l++){if(i[l].Highlight==="None"){i[l].Type="Active"}}}this.getView().getModel("ServicesViewModel").refresh()},onPressCancelCW:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/CWMaterial");for(var t=0;t<e.length;t++){e[t].Highlight="None";e[t].Type="Active"}this.getView().getModel("ServicesViewModel").setProperty("/CWMaterial","");this.getView().getModel("ServicesViewModel").setProperty("/CWMaterial",e);this.getView().getModel("ServicesViewModel").refresh()},onPressCancelGas:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/LPGMaterial");for(var t=0;t<e.length;t++){e[t].Highlight="None";e[t].Type="Active"}this.getView().getModel("ServicesViewModel").setProperty("/LPGMaterial","");this.getView().getModel("ServicesViewModel").setProperty("/LPGMaterial",e);this.getView().getModel("ServicesViewModel").refresh()},onPressCheckCard:function(){if(!this.RewardCheck){this.RewardCheck=sap.ui.xmlfragment("viapp.fragment.RewardCheck",this);this.getView().addDependent(this.RewardCheck)}this.RewardCheck.open()},onPressCloseCheckCard:function(){this.RewardCheck.close()},onCloseCart:function(){sap.m.MessageBox.confirm("Are you sure want to close?",{icon:sap.m.MessageBox.Icon.CONFIRM,title:"Confirmation",actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(e){if(e==="YES"){this.AddToCart.close();this.getView().getModel("ServicesViewModel").setProperty("/ProceedSOButtomVisible",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/IdentifyVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",false);this.getView().getModel("ServicesViewModel").refresh()}else if(e==="NO"){}}.bind(this)})},onScanSuccess:function(e){if(e.getParameter("cancelled")){t.show("Scan cancelled",{duration:1e3})}else{if(e.getParameter("text")){this.getView().getModel("ServicesViewModel").setProperty("/Loyalty_ScanedID",e.getParameter("text"))}}},onScanError:function(e){t.show("Scan failed: "+e,{duration:1e3})},onScanLiveupdate:function(e){},onPressLPGCart:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/Cart_Material");if(e){if(!this.AddToCartLPG){this.AddToCartLPG=sap.ui.xmlfragment("viapp.fragment.AddToCartLPG",this);this.getView().addDependent(this.AddToCartLPG)}this.AddToCartLPG.open();this.getView().getModel("ServicesViewModel").setProperty("/ProceedSOButtomVisible",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/IdentifyVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",false);this.getView().getModel("ServicesViewModel").refresh()}else{sap.m.MessageToast.show("Please Select Material")}},onCloseLPGCart:function(){sap.m.MessageBox.confirm("Are you sure want to close?",{icon:sap.m.MessageBox.Icon.CONFIRM,title:"Confirmation",actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(e){if(e==="YES"){this.AddToCartLPG.close();this.getView().getModel("ServicesViewModel").setProperty("/ProceedSOButtomVisible",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/IdentifyVisible",false);this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",false);this.getView().getModel("ServicesViewModel").refresh()}else if(e==="NO"){}}.bind(this)})},onPressNav1:function(){var e="intent://open?Intent;scheme=https;package=com.marsdata.fabpos.Mars.Splash_Screen;end;";window.location.href(e)},onPressNav2:function(){window.location.href="intent://your_path_pattern?param_key=value#Intent;scheme=your_scheme;package=com.your.package.name;end;";var e="intent://Mars.Splash_Screen?AMOUNT=10#Intent;scheme=https;package=Mars.Splash_Screen;end;";window.location.href(e)},onGopress:function(){var e=[{BP:"6000000175",BPType:"",Name:"Mohamed Hafiz",Mobile:"+919843647118",Email:"mohamed123@gmail.com",PlateNo:"20621",PlateCode:"A",PlateCat:"Private",Emirates:"Dubai",Manufacturer:"BMW",Model:"BMW",CarType:"SEDAN",VinNo:"5871427853458734",Highlight:"None",Type:"Active"}];this.getView().getModel("SearchViewModel").getData().SearchList=e;this.getView().getModel("SearchViewModel").refresh()},onSelectCustomer:function(e){var i=e.getSource().getBindingContext("SearchViewModel").getObject();var a=this.getView().getModel("SearchViewModel").getData().SearchList;var r=this.getView().getModel("oGlobalModel");if(i.Highlight==="None"){setTimeout(function(){t.show("Seleted")},100);e.getSource().getBindingContext("SearchViewModel").getObject().Highlight="Information";r.getData().Profile_BPNo=i.BP;r.getData().Profile_BPType=i.BPType;r.getData().Profile_Name=i.Name;r.getData().Profile_Mobile=i.Mobile;r.getData().Profile_Email=i.Email;r.getData().Profile_PlateNo=i.PlateNo;r.getData().Profile_PlateCode=i.PlateCode;r.getData().Profile_Emirates=i.Emirates;r.getData().Profile_Model=i.Model;r.getData().Profile_CarType=i.CarType;r.getData().Profile_VINNo=i.VinNo;this.getView().getModel("SearchViewModel").refresh();r.refresh();for(var o=0;o<a.length;o++){if(a[o].Highlight==="None"){a[o].Type="Inactive";e.getSource().removeStyleClass("Cl_SearchCustomerBox");e.getSource().addStyleClass("Cl_SearchCustomerBoxNotSeleted")}}this.SearchVehicle.close()}else{setTimeout(function(){t.show("Un-Seleted")},100);e.getSource().getBindingContext("SearchViewModel").getObject().Highlight="None";for(var o=0;o<a.length;o++){if(a[o].Highlight==="None"){a[o].Type="Active";e.getSource().removeStyleClass("Cl_SearchCustomerBoxNotSeleted");e.getSource().removeStyleClass("Cl_SearchCustomerBox");e.getSource().addStyleClass("Cl_SearchCustomerBoxSeleted")}}}this.getView().getModel("SearchViewModel").refresh()},onPressSearchCustomer:function(e){var t=this.getView().getModel("oGlobalModel");if(!this.SearchVehicle){this.SearchVehicle=sap.ui.xmlfragment("viapp.fragment.SearchVehicle",this);this.getView().addDependent(this.SearchVehicle)}this.SearchVehicle.open()},onPressCreateCustomer:function(){this.SearchVehicle.close();if(!this.Create){this.Create=sap.ui.xmlfragment("viapp.fragment.CreateCustomer",this);this.getView().addDependent(this.Create)}this.Create.open()},onCancelCreateCustomer:function(){this.Create.close()},onPressSaveCustomer:function(){var e=this.getView().getModel("HomeViewModel").getData().CNC_NewCustomer;var i=this.getView().getModel("oViewModel").getData();if(e){if(i.CC_FirstName!==""&&i.CC_MobileNo!==""){t.show("Customer created successfully");this.onClearCNCInput()}else{if(i.CC_FirstName===""){i.CC_FirstName_ValueState="Error";this.getView().getModel("oViewModel").setProperty("/CC_FirstName_ValueState","Error")}if(i.CC_MobileNo===""){i.CC_MobileNo_ValueState="Error";this.getView().getModel("oViewModel").setProperty("/CC_MobileNo_ValueState","Error")}t.show("Please fill mandatory details");this.getView().getModel("oViewModel").refresh(true)}}else{if(i.CC_FirstName!==""&&i.CC_MobileNo!==""&&i.CC_Emirates!==""&&i.CC_Category!==""&&i.CC_PlateCode!==""&&i.CC_PlateNo!==""&&i.CC_Manfacturer!==""&&i.CC_Model!==""){t.show("Customer created successfully");this.onClearCNCInput()}else{if(i.CC_FirstName===""){i.CC_FirstName_ValueState="Error";this.getView().getModel("oViewModel").setProperty("/CC_FirstName_ValueState","Error")}if(i.CC_MobileNo===""){i.CC_MobileNo_ValueState="Error";this.getView().getModel("oViewModel").setProperty("/CC_MobileNo_ValueState","Error")}t.show("Please Fill All Mandatory Details");this.getView().getModel("oViewModel").refresh(true)}}},onMobileNoLiveChange:function(e){var i=e.getSource().getValue();if(i.charAt(0)==="0"){t.show("Mobile number does not start with zero");e.getSource().setValue("")}else{var a=i.replace(/\D/g,"");e.getSource().setValue(a);if(i.length>9){this.getView().getModel("oViewModel").setProperty("/CC_MobileNo_ValueState","None")}else{this.getView().getModel("oViewModel").setProperty("/CC_MobileNo_ValueState","Error")}}},onFirstNameLiveChange:function(e){var t=e.getSource().getValue();t=t.replace(/[^a-zA-Z0-9_ ]/g,"");e.getSource().setValue(t);if(t.length>2){this.getView().getModel("oViewModel").setProperty("/CC_FirstName_ValueState","Information")}else{this.getView().getModel("oViewModel").setProperty("/CC_FirstName_ValueState","Error")}},onOpenManufactureF4:function(e){this.source=e.getSource();if(!this.Manfacturer){this.Manfacturer=sap.ui.xmlfragment("viapp.fragment.ManfacturerF4",this);this.getView().addDependent(this.Manfacturer)}this.Manfacturer.open()},onSearchManufacture:function(e){var t=e.getParameters().value;var i=["Manufacture"];var a=e.getSource().getBinding("items");this.onSearchF4(t,i,a)},onSearchModel:function(e){var t=e.getParameters().value;var i=["Model"];var a=e.getSource().getBinding("items");this.onSearchF4(t,i,a)},onSearchF4:function(e,t,i){var a=[];for(var r=0;r<t.length;r++){a.push(new l(t[r],s.Contains,e))}var o=new l(a);i.filter([o])},onManfacturerConfirm:function(e){var t=this.getView().getModel("oViewModel");t.setProperty("/CC_Model","");t.getData().CC_Manfacturer=e.getParameter("selectedItem").getBindingContext("oViewModel").getObject().Manufacture;e.getSource().getBinding("items").filter([]);var i=t.getProperty("/ModelF4Set");var a=[];a=i.filter(function(e){return e.Manufacture===t.getData().CC_Manfacturer});t.setProperty("/ModelF4",a);t.refresh()},onOpenModelF4:function(e){this.source=e.getSource();if(!this.ModelF4){this.ModelF4=sap.ui.xmlfragment("viapp.fragment.ModelF4",this);this.getView().addDependent(this.ModelF4)}this.ModelF4.open()},onModelConfirm:function(e){var t=this.getView().getModel("oViewModel");t.getData().CC_Model=e.getParameter("selectedItem").getBindingContext("oViewModel").getObject().Model;t.refresh();e.getSource().getBinding("items").filter([])},onResetForm:function(){var e=this.getView().getModel("oViewModel");e.getData().CC_FirstName="";e.getData().CC_MobileNo="";e.getData().CC_Email="";e.getData().CC_Emirates="";e.getData().CC_Category="";e.getData().CC_PlateCode="";e.getData().CC_PlateNo="";e.getData().CC_VINNo="";e.getData().CC_Manfacturer="";e.getData().CC_Model="";e.getData().CC_CarType="";e.refresh()},onCNCSwitchOn:function(e){var t=this.getView().getModel("HomeViewModel");var i=e.getSource().getState();if(i){t.setProperty("/CNC_NewCustomer",true);this.getView().getModel("HomeViewModel").setProperty("/CNC_VehicleForm",false);this.getView().getModel("HomeViewModel").setProperty("/CNC_CustomerForm",true)}else if(!i){t.setProperty("/CNC_NewCustomer",false);this.getView().getModel("HomeViewModel").setProperty("/CNC_VehicleForm",true);this.getView().getModel("HomeViewModel").setProperty("/CNC_CustomerForm",true)}},onPressAddonMaterial:function(){if(!this.MaterialF4){this.MaterialF4=sap.ui.xmlfragment("viapp.fragment.MaterialF4",this);this.getView().addDependent(this.MaterialF4)}this.MaterialF4.open()},onSelectMaterial:function(e){var t=e.getSource().getBindingContext("ServicesViewModel").getObject();var i=this.getView().getModel("ServicesViewModel").getData().MaterialList;if(t.Highlight==="None"){e.getSource().getBindingContext("ServicesViewModel").getObject().Highlight="Information";e.getSource().removeStyleClass("cl_wgridlist");e.getSource().addStyleClass("cl_wgridlistSeleted");var a={Material:t.MATERIAL,MaterialName:t.MATDESC,Price:t.NETPRICE,Tax:t.TaxPrice,Total:t.Total,Quantity:t.Quantity};var r=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");r.push(a);this.getView().getModel("ServicesViewModel").refresh();var o=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount",o.length)}else{e.getSource().getBindingContext("ServicesViewModel").getObject().Highlight="None";e.getSource().removeStyleClass("cl_wgridlistSeleted");e.getSource().addStyleClass("cl_wgridlist");var r=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");r=r.filter(function(e){return e.Material!==t.MATERIAL});this.getView().getModel("ServicesViewModel").setProperty("/MyCartItems",r);this.getView().getModel("ServicesViewModel").refresh();var o=this.getView().getModel("ServicesViewModel").getProperty("/MyCartItems");this.getView().getModel("ServicesViewModel").setProperty("/MyCartCount",o.length)}this.getView().getModel("ServicesViewModel").refresh()},onCloseMaterialF4:function(){this.MaterialF4.close()},getMaterialF4:function(){this.getView().getModel("CarwashService").read("/Material_V",{success:function(e,t){var i=[];for(var a=0;a<e.results.length;a++){var r=e.results[a].MATERIAL;r=r.replaceAll("0","");var o=parseFloat(e.results[a].NETPRICE)*.05;var l=o+parseFloat(e.results[a].NETPRICE);var s={MATERIAL:r,MATTYPE:e.results[a].MATTYPE,UOM:e.results[a].UOM,PLANT:e.results[a].PLANT,MATDESC:e.results[a].MATDESC,CONDREC:e.results[a].CONDREC,NETPRICE:e.results[a].NETPRICE,CURRENCY:e.results[a].CURRENCY,Highlight:"None",TaxPrice:parseFloat(o).toFixed(2),Quantity:"1",Total:parseFloat(l).toFixed(2)};i.push(s)}this.getView().getModel("ServicesViewModel").setProperty("/MaterialList",i)}.bind(this),error:function(e){i.error(e.message)}})},onPresspayment:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/SO_Number");var t=this.getView().getModel("ServicesViewModel").getProperty("/SO_id");var a=this.getView().getModel("ServicesViewModel").getProperty("/MyCartTotal");var o=this.getView().getModel("ServicesViewModel").getProperty("/Cash_CheckBoxSeleted");var l=this.getView().getModel("ServicesViewModel").getProperty("/Card_CheckBoxSeleted");var s=this.getView().getModel("ServicesViewModel").getProperty("/Coupon_CheckBoxSeleted");var n=this.getView().getModel("ServicesViewModel").getProperty("/Loyalty_CheckBoxSeleted");var d=this.getView().getModel("ServicesViewModel").getProperty("/Cashamount");var g=this.getView().getModel("ServicesViewModel").getProperty("/CardAmount");var M=this.getView().getModel("ServicesViewModel").getProperty("/CouponAmount");var c=this.getView().getModel("ServicesViewModel").getProperty("/Loyaltyamount");var h=this.getView().getModel("ServicesViewModel").getProperty("/CouponNumber");var u=this.getView().getModel("ServicesViewModel").getProperty("/LoyaltyRef");var p=this.getView().getModel("ServicesViewModel").getProperty("/Authcode");var C=[];var v=0;var w="";var m=new Date;var P=sap.ui.core.format.DateFormat.getDateInstance({pattern:"yyyyMMdd"});m=P.format(m);var S=this.getView().getModel("oGlobalModel").getProperty("/MainPlant");var V="9300";var y=e.toString();var f=m+S+V+y.slice(6);if(o===true&&parseFloat(d)>0){v=v+1;var N={MOP_COUNTER:v.toString(),MOP_TYPE:"CASH",AMOUNT:d,CURRENCY:"AED"};C.push(N)}if(l===true&&parseFloat(g)>0){w="X";v=v+1;var N={MOP_COUNTER:v.toString(),MOP_TYPE:"CARD",AMOUNT:g,CURRENCY:"AED",AUTH_CODE:p};C.push(N)}if(n===true&&parseFloat(c)>0){v=v+1;var N={MOP_COUNTER:v.toString(),MOP_TYPE:"LOYALTY",AMOUNT:c,CURRENCY:"AED",AUTH_CODE:u};C.push(N)}if(s===true&&parseFloat(M)>0){v=v+1;var N={MOP_COUNTER:v.toString(),MOP_TYPE:"COUPON",AMOUNT:M,CURRENCY:"AED",AUTH_CODE:h};C.push(N)}var T=parseFloat(d)+parseFloat(g)+parseFloat(c)+parseFloat(M);var A=parseFloat(a)-parseFloat(T);if(parseFloat(a)===parseFloat(T)){var x={ORDER_KEY_ID:t,ORDERNUM:e.toString(),AMOUNT:a,CURRENCY:"AED",INVOICE:f,ITEMS:C};r.show();this.getView().getModel("CarwashService").create("/Payment",x,{success:function(e,t){r.hide();if(e.ID){if(w){sap.m.MessageBox.confirm(e.ORDERNUM+" data Saved Successfully"+"\n"+"Card Amount "+g+" AED detected"+"\n"+"Are you sure want to pay by card?",{icon:sap.m.MessageBox.Icon.CONFIRM,title:"Confirmation",actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:function(e){if(e==="YES"){this.onPressNavtoPaymentapp()}else if(e==="NO"){}}.bind(this)})}else{sap.m.MessageToast.show(e.ORDERNUM+" data Saved Successfully");this.getView().getModel("ServicesViewModel").setProperty("/MOPVisible",false);this.ongetSOdetails();if(l===false){i.success(e.ORDERNUM+" Data Saved Successfully",{icon:sap.m.MessageBox.Icon.SUCCESS,title:"Success",actions:["Print",sap.m.MessageBox.Action.CANCEL],onClose:function(e){if(e==="Print"){this.onnewprint()}else if(e==="CANCEL"){this._ModelInitialLoad();this._oRouter=sap.ui.core.UIComponent.getRouterFor(this);this._oRouter.navTo("Home",true)}}.bind(this)})}}}}.bind(this),error:function(e){r.hide();i.error(e.message)}.bind(this)})}else{sap.m.MessageToast.show("Total amount does not match with Sales order amount.")}},onPressNavtoPaymentapp:function(){sap.m.MessageToast.show("Navigating to payment app");var e=this.getView().getModel("ServicesViewModel").getProperty("/SO_Number");var t=this.getView().getModel("ServicesViewModel").getProperty("/MyCartTotal");var i={Saleorder:"",Invoice:"",MOPType:"",CardNo:"",Authcode:"",TransactionMessage:""};var a=JSON.stringify(i);let r="com.sap.mobile.start://navigation?resolve-type=ibn#CW-display?sap-ui-app-id-hint=saas_approuter_viapp";let o=encodeURIComponent(r);e=e.toString();var l={txnType:"SALE",txnAmount:t,txnMode:"card",txnID:e,txnInvoice:e.slice(4)};var s=JSON.stringify(l);var n=encodeURIComponent(s);console.log(o);var d="adnoc://sapmetapay.com/card?data="+n+"&returnUrl="+o;window.location.href=d},ongetSOdetails:function(){var e=this.getView().getModel("ServicesViewModel").getProperty("/SO_Number");var t="";this.getView().getModel("CarwashService").read("/OrderRead",{filters:[new l("ORDERNUM",s.EQ,e)],urlParameters:{$expand:"ITEMS"},success:function(e,t){var i="";var a=e.results[0].ITEMS.results;this.getView().getModel("oGlobalModel").setProperty("/ItemARR",a);this.getView().getModel("oGlobalModel").setProperty("/PlateNo",e.results[0].PLATENUM);this.getView().getModel("oGlobalModel").setProperty("/PlateCode",e.results[0].PLATECODE);this.getView().getModel("oGlobalModel").setProperty("/Kind",e.results[0].KIND);this.getView().getModel("oGlobalModel").setProperty("/Source",e.results[0].SOURCE);this.getView().getModel("oGlobalModel").setProperty("/INVOICENo",e.results[0].INVOICE);this.getView().getModel("oGlobalModel").setProperty("/SOnumber",e.results[0].ORDERNUM.toString());if(a.length!==0){var r=a[0].PLANT;this.getView().getModel("oGlobalModel").setProperty("/MainPlant",r)}this.ongetMOPDetails()}.bind(this),error:function(e){i.error(e.message)}.bind(this)})},saveDetails:function(e){var t={ID:e.ID,PARENT_KEY_ID:e.PARENT_KEY_ID,MOP_COUNTER:e.MOP_COUNTER,AMOUNT:e.AMOUNT,CURRENCY:e.CURRENCY,MOP_TYPE:e.MOP_TYPE,AUTH_CODE:e.AUTH_CODE};var a=this.getView().getModel("CarwashService");var r="";r=a.createKey("/PaymentItem",{ID:e.ID});a.sDefaultUpdateMethod=sap.ui.model.odata.UpdateMethod.Put;a.update(r,t,{success:function(e,t){if(e.ID){sap.m.MessageToast.show("Payment Details Updated successfully")}}.bind(this),error:function(e){i.error(e.message)}.bind(this)})},ongetMOPDetails:function(){var e=this.getView().getModel("oGlobalModel").getProperty("/SOnumber");this.getView().getModel("CarwashService").read("/Payment",{filters:[new l("ORDERNUM",s.EQ,e)],urlParameters:{$expand:"ITEMS"},success:function(e,t){if(e.results[0].length!==0){var i=e.results[0].ITEMS.results;this.getView().getModel("oGlobalModel").setProperty("/MOPItems",i);this.getView().getModel("ServicesViewModel").setProperty("/Printvisible",true);this.getView().getModel("ServicesViewModel").setProperty("/PaymentButtomVisible",false)}}.bind(this),error:function(e){i.error(e.message)}.bind(this)})},onnewprint:function(){const e="892 - Industrial Area, Near 2Nd Signal - Musaffah";const t="2024112050160";var i=this.getView().getModel("oGlobalModel").getData();this.Lineitems=[];var a=i.ItemARR;var r=i.MOPItems;var o=i.MainPlant;var l=i.PlateNo;var s=i.PlateCode;var n=i.Kind;var d=i.Source;var g=i.SOnumber;var M=i.INVOICENo;var c=new Date;var h=new Date;var u=sap.ui.core.format.DateFormat.getDateInstance({pattern:"dd/MM/yyyy"});var p=sap.ui.core.format.DateFormat.getTimeInstance({pattern:"HH:mm:ss"});c=u.format(c);h=p.format(h);var C=[];for(var v=0;v<a.length;v++){var w=parseFloat(a[v].NETPRICE)+parseFloat(a[v].NETPRICE)*.05;var m={Name:a[v].MATERIALDESC,Qty:1,Price:a[v].NETPRICE,Total:parseFloat(w).toFixed(2)};C.push(m)}var P=C.map(e=>e.Total).reduce((e,t)=>parseFloat(e)+parseFloat(t));var S=parseFloat(P).toFixed(2);var V=parseFloat(S)*.05;V=parseFloat(V).toFixed(2);const y=`\n        <!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Invoice</title>\n    <style>\n\t\t@page {\n\t\t\tsize: 58mm auto; \n\t\t\tmargin: 0;\n\t\t}\n        body {\n            font-family: Arial, sans-serif;\n            font-size: 20px;\n            margin: 0;\n            padding: 0;\n            background: #f4f4f4;\n        }\n\n        .invoice-container {\n\t\t    size: 58mm auto; \n            width: 310px;  /* Set width suitable for receipt printers */\n            margin: auto;\n            background: #fff;\n            padding: 10px;\n            // border: 1px solid #ddd;\n        }\n\n        .invoice-header {\n            text-align: center;\n            border-bottom: 1px dashed #ddd;\n            padding-bottom: 10px;\n            margin-bottom: 10px;\n        }\n\n        .invoice-header img {\n            max-width: auto;\n            margin-bottom: 5px;\n        }\n\n        .invoice-header h2 {\n            font-size: 24px;\n            margin: 0;\n        }\n\n        .invoice-header p {\n            margin: 0;\n            font-size: 18px;\n            color: #555;\n        }\n\n        .invoice-details {\n            margin-bottom: 10px;\n             margin-Top: 10px;\n            border-Top: 1px solid #ddd;\n            /*border-bottom: 1px solid #ddd;*/\n            \n        }\n\n        .invoice-details p {\n            margin: 2px 0;\n            font-size: 18px;\n        }\n\n        .invoice-items {\n            width: 100%;\n            // border-collapse: collapse;\n            margin-bottom: 10px;\n        }\n\n        .invoice-items th, .invoice-items td {\n            text-align: left;\n            font-size: 16px;\n            padding: 0;\n        }\n\n        .invoice-items th {\n            background: #f4f4f4;\n            border-bottom: 2px solid #ddd;\n        }\n\n        .invoice-items td {\n            border-bottom: 2px dashed #ddd;\n        }\n\n        .invoice-totals {\n            text-align: right;\n            font-size: 20px;\n            border-bottom: 2px dashed #ddd;\n        }\n\n        .invoice-totals p {\n            margin: 2px 0;\n        }\n\t\t.total {\n              font-weight: bold;\n         }\n\n        .invoice-footer {\n            text-align: Center;\n            /*border-top: 1px dashed #ddd;*/\n            /*padding-top: 1px;*/\n            /*margin-top: 10px;*/\n            font-size: 18px;\n        }\n        \n        .invoice-Number {\n            text-align: center;\n            border-top: 1px dashed #ddd;\n            border-bottom: 1px dashed #ddd;\n            padding-top: 1px;\n            margin-top: 1px;\n            font-size: 18px;\n        }\n        .Tax_line {\n             border-bottom: 1px dashed #ddd;\n        }\n\n    </style>\n   \n</head>\n<body>\n    <div class="invoice-container">\n        \x3c!-- Invoice Header --\x3e\n        <div class="invoice-header">\n            <img src="{imageModel>/path}/image/NewLogo.png" alt="ADNOC Distribution" width="70"/>\n            \x3c!--<h4>ADNOC Distribution</h4>--\x3e\n            \x3c!--<P><b>ADNOC Distribution</b></p>--\x3e\n            // <p style="font-size: 15px;" >**** Duplicate Copy ****</p>\n             <p>TAX INVOICE</p>\n             <p>TRN: 100069993200003</p>\n            <P>ADNOC Distribution</p>\n            <p>P.O Box 4188, Abu Dhabi UAE</p>\n            <p>Site: ${e}</p>\n        </div>\n        \n        <table id="data-table" class="invoice-items">\n                        <thead>\n                            <tr>\n                                <th>Item</th>\n                                <th>Qty</th>\n                                <th>Price</th>\n                                <th>Total</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${C.map(e=>`\n                                    <tr>\n                                        <td>${e.Name}</td>\n                                        <td>${e.Qty}</td>\n                                        <td>${e.Price}</td>\n                                         <td>${e.Total}</td>\n                                    </tr>\n                                `).join("")}\n                            <tr class="total">\n                                <td colspan="3">Total</td>\n                                <td>${S}</td>\n                            </tr>\n                        </tbody>\n                    </table>\n          \n          <div class="invoice-details">\n            <P>Payment Mode</P>\n            \x3c!--<li id="subjectList"></li>--\x3e\n           <ul id="item-list">\n\x3c!-- List items will be added dynamically --\x3e\n\t\t\t                      ${r.map(e=>` <li>${e.MOP_TYPE}  :  ${e.AMOUNT}</li> `).join("")}\n</ul>\n          </div>\n          \n\n            \n        \n         <div class="invoice-details">\n                <p><center>You could have earned Points! </br> Sign up for ADNOC Rewords Now!</center></p>\n                <center><img src="data:image/png;base64,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" alt="ADNOC Rewords" width="70"></center>\n                \n            </div> \n            \n            <div class="invoice-details">\n                <p style="font-size: 16px"><center>Price Inclusive of VAT </br> VAT Summary</center></p>\n              <table style="width:100%" class="invoice-items">\n                <tr>\n                  <td>VAT-Code</td>\n                  <td>Amount</td>\n                  <td>VAT-Rate</td>\n                  <td>VAT(AED)</td>\n                </tr>\n                <tr style="text-align: center">\n                  <td>C</td>\n                  <td>${S}</td>\n                  <td>5%</td>\n                  <td>${V}</td>\n                </tr>\n              </table>\n          </div>\n                \n        \n          <div class="invoice-details">\n            <div >\n                <p>Date: ${c} ${h}</p>\n                <p>Transcation No: ${g}</p>\n                <p>Invoice No: ${M}</p>\n                <p>RRN: 432611326923</p>\n                // <p>Attender Id: 43261</p>\n\t\t\t\t<p>Plate No/Code: ${l}/${s}</p>\n\t\t\t\t<p>Emirates: ${d}</p>\n            </div> \n          </div>  \n\n            <div class="invoice-details">\n              </br>\n                <center><img src="data:image/png;base64,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" alt="ADNOC Rewords" width="70">\n                  </center>   \n                  <center><p>Claim Rewards QR</p></center>\n            </div> \n            \n        \x3c!-- Invoice Footer --\x3e\n                 <center>\n                   <p>Thank You </br> Contact Us: 800300 </br> www.adnocdistribution.com</p>\n                 </center>\n                \n            \n    </div>\n</body>\n</html>`;const f=new Blob([y],{type:"text/html"});const N=URL.createObjectURL(f);const T=window.open(N,"_blank");if(T){T.onload=function(){T.print();URL.revokeObjectURL(N)}}else{sap.m.MessageToast.show("Unable to open the print window. Please check your browser settings.")}this._ModelInitialLoad();this._oRouter=sap.ui.core.UIComponent.getRouterFor(this);this._oRouter.navTo("Home",true)}})});
//# sourceMappingURL=Services.controller.js.map